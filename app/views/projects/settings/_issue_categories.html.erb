<% if @project.issue_categories.any? %>
<table class="list">
  <thead><tr>
    <th><%= l(:label_issue_category) %></th>
    <th><%= l(:field_assigned_to) %></th>
    <th></th>
  </tr></thead>
  <tbody>
<% for category in @project.issue_categories %>
  <% unless category.new_record? %>
  <tr class="<%= cycle 'odd', 'even' %>">
    <td class="name"><%=h(category.name) %></td>
    <td><%=h(category.assigned_to.name) if category.assigned_to %></td>
    <td class="buttons">
      <% if User.current.allowed_to?(:manage_categories, @project) %>
        <%= link_to l(:button_edit), edit_issue_category_path(category), :class => 'icon icon-edit' %>
        <%= delete_link issue_category_path(category) %>
      <% end %>
    </td>
  </tr>
  <% end %>
<% end %>
    </tbody>
</table>
<% else %>
<p class="nodata"><%= l(:label_no_data) %></p>
<% end %>
<p><%= link_to l(:label_issue_category_new), new_project_issue_category_path(@project), :class => 'icon icon-add' if User.current.allowed_to?(:manage_categories, @project) %></p>
<% strict_inherited = (@project.inherited_categories(true) - @project.issue_categories) %>
<% if ! strict_inherited.empty? %>
  <% masked = false %>
  <% inherited = @project.inherited_categories %>
  <h3><%= l(:text_issue_categories_inherited) %></h3>
  <table class="list">
    <thead><tr>
		<th><%= l(:label_project) %></th><th><%= l(:label_issue_category) %></th>
	</tr></thead>
	<tbody>
	  <% projs = @project.inherited_projects; projs.shift %>
	  <% for p in projs %>
	    <% for c in p.issue_categories %>
		  <tr>
		    <td><%= format_project(p, projs) %></td>
			<td><%= c.name %>
			  <% if ! inherited.include?(c) %>*<% masked = true %><% end %>
			</td>
		  </tr>
		<% end %>
	  <% end %>
	</tbody>
  </table>
  <% if masked %>
    <p>* : <%= l(:text_issue_category_masked) %></p>
  <% end %>
<% end %>
